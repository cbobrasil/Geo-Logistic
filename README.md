# **Geo-Logistic**

## üåç Overview: 

The **Geo-Logistic** project simulates a complete logistics data workflow from synthetic order generation to daily route optimization and automatic web publishing.  

The process:

1. Generate data - Creates CSV files of daily orders and warehouses - Python (Pandas, Faker)
2. Calculate routes - Calls the OSRM API to compute optimized delivery routes and generate maps - Python + Requests + Folium
3. Render - Organizes HTMLs by date and builds the homepage - Python
4. Publish - Deploys all generated HTMLs automatically to the web - GitHub Actions + GitHub Pages

### üöÄ About GitHub Pages & Actions

The project uses **GitHub Actions** for automation and **GitHub Pages** for hosting.  
Every time the workflow runs, GitHub Actions:
1. Executes the Python scripts that generate and consolidate new data
2. Builds and renders the interactive route maps
3. Publishes the output automatically to **GitHub Pages**

This means the site is **rebuilt and redeployed daily**, using the configuration defined in the repository‚Äôs deployment pipeline.

üîó The final result is a [public website]  (https://cbobrasil.github.io/Geo-Logistic/) generated automatically that displays the optimized delivery routes for each day.


## ‚öôÔ∏è installation and setup

Run the following commands from the project root directory.

1. **install python 3.12 or later**

- windows: download from [python.org/downloads](https://www.python.org/downloads/)
- check version:
    ```bash
    python --version
    ```

2. **create and activate a virtual environment**

   ```bash
   python -m venv .venv
   # windows
   .\.venv\Scripts\activate
   # mac/linux
   source .venv/bin/activate
   ```

3. **install dependencies**
    ```bash
    pip install -r requirements.txt
    ```


## üèÉ how to run 


1. **generate orders for a date range**

- creates one .csv file per day within the defined start and end dates in the script.

     ```bash
     python src/create_orders_per_period.py
     ```

2. **generate orders only for the current day**


- creates a `single.csv` file containing today‚Äôs orders.

     ```bash
     python src/create_orders_today.py
     ```

3. **consolidate all daily files - Optional**

- merges all generated .csv files into one .parquet and .csv file inside the silver layer.

     ```bash
     python src/consolidate_duckdb.py
     ```

4. **the output**

- The outputs generated by both scripts (per period and per today) are saved under `data/bronze/`

     ```
     orders_pt_YYYY-MM-DD.csv
     warehouse_pt.csv
     ```

- The optional output of the consolidate orders will be saved in `data/silver/` :

     ```
     orders_all.parquet
     orders_all.csv
     ```

5. **generate and publish optimized routes**

- Each day can be transformed into an interactive html map using osrm + folium.
- Run the script that calculates the best route for a given date (used internally by the render process):

    ```bash
    python src/calculate_best_route.py 
    ```

- This script uses the files:
   - `data/bronze/orders_pt_2025-10-12.csv `
   - `data/bronze/warehouse_pt.csv`
  
- Contacts the free osrm api
- Computes the optimal route using the traveling salesman route algorithm.
- Produces a Folium-based HTML map and saves both the HTML file and the optimized sequence for that day.
- Generate the files: 
    - `site/2025-10-12/index.html`
    - `site/2025-10-12/optimized_sequence.csv`


6. **render daily pages automatically**

- To automate rendering, use the helpers under `src/render/`:

    - `build_day.py` ‚Üí generates the html and csv for one date
    - `build_index.py` ‚Üí builds a homepage with a date picker and list of available dates

    ```bash
    python src/render/build_day.py --date 2025-10-12
    python src/render/build_index.py
    ```

7. **preview locally**

 - serve the generated site locally to view the pages:

    ```bash
    python -m http.server --directory site 8010
    ```

- in your browser open http://localhost:8010/  to check the route 


## üí° Understanding the scripts

**calculate_best_route.py** 

Read the orders at `orders_pt_YYYY-MM-DD.csv` and `warehouse_pt.csv`. Send the coordinates of the points to the OSRM service (Open Source Routing Machine) and calculate the best route moving from the warehouse, doing the deliveries and going back to the warehouse. It generates 2 main outputs, a HTML interactive map (route_map.html) created using Folium, and an optimized delivery route sequence for the day in a CSV (optimized_sequence.csv)


## Defining the best route

The script defined in `calculate_best_route.py` is used to compute the best route given a maximum unmber of orders.
It uses the /trip endpoint from OSRM public API. It solves a variation of the [Travelling Salesman Problem](https://en.wikipedia.org/wiki/Travelling_salesman_problem) finding the shortest possible route starting from a fixed location (warehouse), visiting all destinations exactly once and returning to the origin. 

```python
params = {
    "source": "first",      # warehouse
    "roundtrip": "true",    # return to origin
    "overview": "full",     # geometric details of the route
    "geometries": "geojson" # easy format to a map
}
```

The OSRM API returns a JSON with:

- trips: the total distance of the trip, the estimated time and the geometry of the route.
- waypoints: the optimized order of visit (rearranged indexes)

Using this response, the script reorganize the orders by `waypoint_index`, creating an optimized sequence for deliveries.


**build_day.py**

It calls the calculate_best_route script looping for all the days that exists in the `data/bronze` layer. Then it saves the HTML and CSV inside  `site/YYYY-MM-DD/`

**build_index.py**

Creates an `index.html` paging listing all the existing days found  in `data/bronze` layer. 


## Rendering Data 

The scripts (`build_day.py `// `build_index.py`) read the generated data and create front-end assets, HTML pages with interactive maps located `site/YYYY-MM-DD/index.html` 
Those pages contain the map, the delivery points, and links.

